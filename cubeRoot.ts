LyoqCiAqIFBzZXVkbyBjb2RlIGZvciBjYWxjdWxhdGluZyBjdWJlIHJvb3Qgb2YgbgogKgogKiBUaGlzIGltcGxlbWVudGF0aW9uIHVzZXMgTmV3dG9uJ3MgbWV0aG9kIGZvciBmaW5kaW5nIGN1YmUgcm9vdHMuCiAqIE5ld3RvbidzIG1ldGhvZCBpcyBhbiBpdGVyYXRpdmUgcm9vdC1maW5kaW5nIGFsZ29yaXRobSB0aGF0IHVzZXMgCiAqIHN1Y2Nlc3NpdmUgYXBwcm94aW1hdGlvbnMgdG8gZmluZCBpbmNyZWFzaW5nbHkgYWNjdXJhdGUgc29sdXRpb25zLgogKgogKiBGb3IgY3ViZSByb290cywgd2UncmUgc29sdmluZzogeMKzIC0gbiA9IDAKICogVGhlIE5ld3RvbidzIG1ldGhvZCBmb3JtdWxhIGJlY29tZXM6IHhfbmV3ID0geCAtICh4wqMgLSBuKSAvICgzeMKyKQogKiBXaGljaCBzaW1wbGlmaWVzIHRvOiB4X25ldyA9ICgyeCArIG4veMKyKSAvIDMKICoKICogVGhlIG1ldGhvZDoKICogLSBTdGFydCB3aXRoIGFuIGluaXRpYWwgZ3Vlc3MKICogLSBJdGVyYXRpdmVseSBpbXByb3ZlIHRoZSBndWVzcyB1c2luZyBOZXd0b24ncyBmb3JtdWxhCiAqIC0gU3RvcCB3aGVuIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gaXRlcmF0aW9ucyBpcyBzbWFsbGVyIHRoYW4gdG9sZXJhbmNlCiAqCiAqIFRpbWUgY29tcGxleGl0eTogTyhsb2cgbikgLSBjb252ZXJnZXMgcXVhZHJhdGljYWxseQogKiBTcGFjZSBjb21wbGV4aXR5OiBPKDEpIC0gY29uc3RhbnQgc3BhY2UKKI0KZnVuY3Rpb24gY3ViZVJvb3QobiwgdG9sZXJhbmNlID0gMC4wMDAwMSkKICAgIC8vIEhhbmRsZSBlZGdlIGNhc2VzCiAgICBpZiBuID09IDAKICAgICAgICByZXR1cm4gMAogICAgaWYgbiA9PSAxCiAgICAgICAgcmV0dXJuIDEKICAgIAogICAgLy8gSGFuZGxlIG5lZ2F0aXZlIG51bWJlcnMgKGN1YmUgcm9vdCBvZiBuZWdhdGl2ZSBpcyBuZWdhdGl2ZSkKICAgIHNpZ24gPSAxCiAgICBpZiBuIDwgMAogICAgICAgIHNpZ24gPSAtMQogICAgICAgIG4gPSBhYnNvbHV0ZShuKQogICAgCiAgICAvLyBJbml0aWFsaXplIGd1ZXNzIC0gZm9yIGN1YmUgcm9vdCwgbi8zIGlzIG9mdGVuIGEgZ29vZCBzdGFydGluZyBwb2ludAogICAgLy8gQnV0IG4vMiBhbHNvIHdvcmtzIHdlbGwgYW5kIGlzIHNpbXBsZQogICAgZ3Vlc3MgPSBuIC8gMgogICAgCiAgICAvLyBGb3IgdmVyeSBzbWFsbCBudW1iZXJzLCBzdGFydCB3aXRoIGEgZ3Vlc3MgY2xvc2VyIHRvIDEKICAgIGlmIG4gPCAxCiAgICAgICAgZ3Vlc3MgPSAxCiAgICAKICAgIC8vIEl0ZXJhdGUgdW50aWwgd2UgcmVhY2ggZGVzaXJlZCBhY2N1cmFjeQogICAgd2hpbGUgdHJ1ZQogICAgICAgIC8vIENhbGN1bGF0ZSBpbXByb3ZlZCBndWVzcyB1c2luZyBOZXd0b24ncyBtZXRob2QKICAgICAgICAvLyBGb3JtdWxhOiB4X25ldyA9ICgyKnggKyBuL3jCsikgLyAzCiAgICAgICAgbmV3R3Vlc3MgPSAoMiAqIGd1ZXNzICsgbiAvIChndWVzcyAqIGd1ZXNzKSkgLyAzCiAgICAgICAgCiAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgY29udmVyZ2VkIChkaWZmZXJlbmNlIGlzIGxlc3MgdGhhbiB0b2xlcmFuY2UpCiAgICAgICAgaWYgYWJzb2x1dGUobmV3R3Vlc3MgLSBndWVzcykgPCB0b2xlcmFuY2UKICAgICAgICAgICAgcmV0dXJuIHNpZ24gKiBuZXdHdWVzcwogICAgICAgIAogICAgICAgIC8vIFVwZGF0ZSBndWVzcyBmb3IgbmV4dCBpdGVyYXRpb24KICAgICAgICBndWVzcyA9IG5ld0d1ZXNz